name: RDP
on:
  workflow_dispatch:

jobs:
  windows-browser:
    runs-on: windows-latest
    steps:
      - name: Setup VNC & noVNC
        run: |
          choco install tightvnc -y
          & "C:\Program Files\TightVNC\tvnserver.exe" -install
          & "C:\Program Files\TightVNC\tvnserver.exe" -controlapp -setpassword "cloud123"
          net start "TightVNC Server"
          npm install -g novnc localtunnel

      - name: Start Web Bridge & Tunnel
        shell: pwsh
        run: |
          # 1. Get the Public IP (This is your bypass password)
          $ip = Invoke-RestMethod http://ipinfo.io/ip
          
          Write-Host "`n=========================================="
          Write-Host "âœ… BYPASS PASSWORD (IP): $ip"
          Write-Host "==========================================`n"

          # 2. Start noVNC bridge
          Start-Process powershell -ArgumentList "-NoProfile -Command & {novnc --vnc localhost:5900 --listen 8080}"
          
          # 3. Launch Localtunnel
          # Once you click the link, paste the IP above into the 'Tunnel Password' box
          lt --port 8080

      - name: Keep Alive
        run: |
          while($true) { Start-Sleep -Seconds 300 }
